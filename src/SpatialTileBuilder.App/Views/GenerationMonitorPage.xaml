<Page
    x:Class="SpatialTileBuilder.App.Views.GenerationMonitorPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:vm="clr-namespace:SpatialTileBuilder.App.ViewModels"
    xmlns:converters="clr-namespace:SpatialTileBuilder.App.Converters"
    mc:Ignorable="d"
    Background="{DynamicResource MaterialDesignPaper}">

    <Page.Resources>
        <converters:StringFormatConverter x:Key="StringFormatConverter"/>
        <converters:BoolNegationConverter x:Key="BoolNegationConverter"/>
    </Page.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <TextBlock Text="Generation Monitor" FontSize="24" FontWeight="Bold" Margin="0,0,0,24"/>

        <!-- Status Header -->
        <Border Grid.Row="1" Background="{DynamicResource MaterialDesignCardBackground}" CornerRadius="8" Padding="24" Margin="0,0,0,24">
            <StackPanel>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="{Binding ViewModel.StatusText, Mode=OneWay}" FontSize="18" FontWeight="SemiBold"/>
                    <TextBlock Text="{Binding ViewModel.StatsText, Mode=OneWay}" Grid.Column="1" HorizontalAlignment="Right" Foreground="Gray"/>
                </Grid>
                
                <ProgressBar Value="{Binding ViewModel.ProgressValue, Mode=OneWay}" Height="20"/>
                
                <Grid>
                    <TextBlock Text="{Binding ViewModel.ProgressValue, Mode=OneWay, Converter={StaticResource StringFormatConverter}, ConverterParameter='{}{0:F1}%'}" HorizontalAlignment="Center"/>
                </Grid>
            </StackPanel>
        </Border>

        <!-- Controls -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,24">
             <Button Command="{Binding ViewModel.StartGenerationCommand}" Content="Start" Width="100" IsEnabled="{Binding ViewModel.IsGenerating, Mode=OneWay, Converter={StaticResource BoolNegationConverter}}"/>
             <Button Command="{Binding ViewModel.PauseCommand}" Content="Pause" Width="100" IsEnabled="{Binding ViewModel.IsGenerating, Mode=OneWay}"/>
             <Button Command="{Binding ViewModel.ResumeCommand}" Content="Resume" Width="100" IsEnabled="{Binding ViewModel.IsPaused, Mode=OneWay}"/>
             <Button Command="{Binding ViewModel.CancelCommand}" Content="Cancel" Width="100" IsEnabled="{Binding ViewModel.IsGenerating, Mode=OneWay}"/>
        </StackPanel>

        <!-- Logs -->
        <TextBlock Grid.Row="3" Text="Logs" FontWeight="SemiBold" Margin="0,0,0,8" VerticalAlignment="Top"/>
        <Border Grid.Row="3" BorderBrush="{DynamicResource MaterialDesignDivider}" BorderThickness="1" CornerRadius="4" Margin="0,28,0,0">
            <ListView ItemsSource="{Binding ViewModel.Logs}" ScrollViewer.VerticalScrollBarVisibility="Auto">
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <TextBlock Text="{Binding}" FontSize="12" FontFamily="Consolas"/>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
        </Border>
    </Grid>
</Page>
